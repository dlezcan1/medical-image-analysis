
img_size =

   216   256    16     1

Training UNet...
[Warning: MATLAB has disabled some advanced graphics rendering features by switching to software OpenGL. For more information, click <a href="matlab:opengl('problems')">here</a>.] 
Initializing input data normalization.
|======================================================================================================================|
|  Epoch  |  Iteration  |  Time Elapsed  |  Mini-batch  |  Validation  |  Mini-batch  |  Validation  |  Base Learning  |
|         |             |   (hh:mm:ss)   |   Accuracy   |   Accuracy   |     Loss     |     Loss     |      Rate       |
|======================================================================================================================|
|       1 |           1 |       00:00:10 |       48.78% |       47.16% |       0.8922 |       0.8712 |          0.0500 |
|       1 |          20 |       00:00:51 |       84.28% |              |       0.6848 |              |          0.0500 |
|       1 |          40 |       00:01:32 |       94.97% |              |       0.4565 |              |          0.0500 |
|       2 |          60 |       00:02:15 |       94.74% |              |       0.5342 |              |          0.0500 |
|       2 |          80 |       00:02:57 |       98.06% |              |       0.2182 |              |          0.0500 |
|       3 |         100 |       00:03:46 |       96.68% |       96.69% |       0.3928 |       0.3932 |          0.0500 |
|       3 |         120 |       00:04:29 |       96.28% |              |       0.4355 |              |          0.0500 |
|       4 |         140 |       00:05:12 |       97.35% |              |       0.2869 |              |          0.0500 |
|       4 |         160 |       00:05:54 |       98.39% |              |       0.2159 |              |          0.0500 |
|       5 |         180 |       00:06:38 |       97.94% |              |       0.2197 |              |          0.0500 |
|       5 |         200 |       00:07:26 |       98.20% |       97.71% |       0.1575 |       0.2576 |          0.0500 |
|       6 |         220 |       00:08:09 |       98.33% |              |       0.1776 |              |          0.0500 |
|       6 |         240 |       00:08:52 |       97.86% |              |       0.1711 |              |          0.0500 |
|       7 |         260 |       00:09:36 |       98.25% |              |       0.2129 |              |          0.0500 |
|       7 |         280 |       00:10:18 |       98.77% |              |       0.1571 |              |          0.0500 |
|       8 |         300 |       00:11:07 |       98.45% |       98.17% |       0.1783 |       0.2136 |          0.0500 |
|       8 |         320 |       00:11:50 |       98.57% |              |       0.1587 |              |          0.0500 |
|       9 |         340 |       00:12:34 |       98.67% |              |       0.1387 |              |          0.0500 |
|       9 |         360 |       00:13:16 |       98.53% |              |       0.1480 |              |          0.0500 |
|      10 |         380 |       00:14:00 |       98.30% |              |       0.1578 |              |          0.0500 |
|      10 |         400 |       00:14:48 |       98.87% |       98.29% |       0.1406 |       0.2070 |          0.0500 |
|      11 |         420 |       00:15:32 |       97.91% |              |       0.2035 |              |          0.0050 |
|      11 |         440 |       00:16:15 |       98.94% |              |       0.1395 |              |          0.0050 |
|      12 |         460 |       00:16:58 |       98.51% |              |       0.1555 |              |          0.0050 |
|      12 |         480 |       00:17:41 |       99.11% |              |       0.1102 |              |          0.0050 |
|      13 |         500 |       00:18:30 |       98.47% |       98.46% |       0.1573 |       0.1909 |          0.0050 |
|      13 |         520 |       00:19:13 |       99.16% |              |       0.0897 |              |          0.0050 |
|      14 |         540 |       00:19:57 |       99.02% |              |       0.1126 |              |          0.0050 |
|      14 |         560 |       00:20:39 |       99.11% |              |       0.0872 |              |          0.0050 |
|      15 |         580 |       00:21:23 |       98.83% |              |       0.1061 |              |          0.0050 |
|      15 |         600 |       00:22:12 |       98.23% |       98.53% |       0.2957 |       0.1767 |          0.0050 |
|      16 |         620 |       00:22:55 |       99.19% |              |       0.1061 |              |          0.0050 |
|      16 |         640 |       00:23:38 |       98.86% |              |       0.1463 |              |          0.0050 |
|      17 |         660 |       00:24:22 |       99.04% |              |       0.1157 |              |          0.0050 |
|      17 |         680 |       00:25:04 |       98.15% |              |       0.1568 |              |          0.0050 |
|      18 |         700 |       00:25:53 |       98.78% |       98.56% |       0.1159 |       0.1775 |          0.0050 |
|      18 |         720 |       00:26:36 |       98.99% |              |       0.1009 |              |          0.0050 |
|      19 |         740 |       00:27:20 |       99.16% |              |       0.1344 |              |          0.0050 |
|      19 |         760 |       00:28:02 |       98.91% |              |       0.1395 |              |          0.0050 |
|      20 |         780 |       00:28:46 |       98.96% |              |       0.1222 |              |          0.0050 |
|      20 |         800 |       00:29:34 |       98.77% |       98.60% |       0.1037 |       0.1642 |          0.0050 |
|      21 |         820 |       00:30:19 |       98.06% |              |       0.2220 |              |          0.0005 |
|      21 |         840 |       00:31:01 |       98.38% |              |       0.1304 |              |          0.0005 |
|      22 |         860 |       00:31:45 |       99.03% |              |       0.0833 |              |          0.0005 |
|      22 |         880 |       00:32:27 |       98.70% |              |       0.1138 |              |          0.0005 |
|      23 |         900 |       00:33:17 |       99.12% |       98.60% |       0.0797 |       0.1659 |          0.0005 |
|      23 |         920 |       00:34:00 |       98.30% |              |       0.1627 |              |          0.0005 |
|      24 |         940 |       00:34:43 |       98.58% |              |       0.1223 |              |          0.0005 |
|      24 |         960 |       00:35:26 |       98.62% |              |       0.1458 |              |          0.0005 |
|      25 |         980 |       00:36:10 |       98.98% |              |       0.0877 |              |          0.0005 |
|      25 |        1000 |       00:36:58 |       99.10% |       98.68% |       0.0917 |       0.1526 |          0.0005 |
|      26 |        1020 |       00:37:42 |       98.71% |              |       0.1246 |              |          0.0005 |
|      26 |        1040 |       00:38:25 |       99.09% |              |       0.1035 |              |          0.0005 |
|      27 |        1060 |       00:39:08 |       99.14% |              |       0.0801 |              |          0.0005 |
|      27 |        1080 |       00:39:51 |       98.54% |              |       0.1240 |              |          0.0005 |
|      28 |        1100 |       00:40:40 |       98.86% |       98.62% |       0.1119 |       0.1719 |          0.0005 |
|      28 |        1120 |       00:41:23 |       98.52% |              |       0.1928 |              |          0.0005 |
|      29 |        1140 |       00:42:07 |       98.98% |              |       0.1122 |              |          0.0005 |
|      29 |        1160 |       00:42:50 |       98.91% |              |       0.1321 |              |          0.0005 |
|      30 |        1180 |       00:43:33 |       99.16% |              |       0.0799 |              |          0.0005 |
|      30 |        1200 |       00:44:22 |       98.99% |       98.68% |       0.1032 |       0.1648 |          0.0005 |
|      31 |        1220 |       00:45:06 |       98.21% |              |       0.1571 |              |      5.0000e-05 |
|      31 |        1240 |       00:45:48 |       98.95% |              |       0.1444 |              |      5.0000e-05 |
|      32 |        1260 |       00:46:32 |       98.53% |              |       0.1962 |              |      5.0000e-05 |
|      32 |        1280 |       00:47:14 |       99.14% |              |       0.0953 |              |      5.0000e-05 |
|      33 |        1300 |       00:48:04 |       98.90% |       98.63% |       0.1026 |       0.1657 |      5.0000e-05 |
|      33 |        1320 |       00:48:47 |       98.69% |              |       0.1439 |              |      5.0000e-05 |
|      34 |        1340 |       00:49:30 |       98.94% |              |       0.0944 |              |      5.0000e-05 |
|      34 |        1360 |       00:50:13 |       99.05% |              |       0.1445 |              |      5.0000e-05 |
|      35 |        1380 |       00:50:57 |       98.93% |              |       0.1074 |              |      5.0000e-05 |
|      35 |        1400 |       00:51:45 |       98.39% |       98.58% |       0.2303 |       0.1685 |      5.0000e-05 |
|      36 |        1420 |       00:52:29 |       99.01% |              |       0.1020 |              |      5.0000e-05 |
|      36 |        1440 |       00:53:12 |       98.82% |              |       0.1633 |              |      5.0000e-05 |
|      37 |        1460 |       00:53:55 |       98.34% |              |       0.1508 |              |      5.0000e-05 |
|      37 |        1480 |       00:54:38 |       98.65% |              |       0.1564 |              |      5.0000e-05 |
|      38 |        1500 |       00:55:27 |       98.62% |       98.64% |       0.1445 |       0.1639 |      5.0000e-05 |
|      38 |        1520 |       00:56:10 |       98.77% |              |       0.1233 |              |      5.0000e-05 |
|      39 |        1540 |       00:56:54 |       99.19% |              |       0.1065 |              |      5.0000e-05 |
|      39 |        1560 |       00:57:36 |       98.43% |              |       0.1301 |              |      5.0000e-05 |
|      40 |        1580 |       00:58:20 |       98.99% |              |       0.1179 |              |      5.0000e-05 |
|      40 |        1600 |       00:59:08 |       98.66% |       98.62% |       0.1690 |       0.1701 |      5.0000e-05 |
|      41 |        1620 |       00:59:52 |       99.08% |              |       0.0954 |              |      5.0000e-06 |
|      41 |        1640 |       01:00:35 |       98.92% |              |       0.0910 |              |      5.0000e-06 |
|      42 |        1660 |       01:01:18 |       99.09% |              |       0.1083 |              |      5.0000e-06 |
|      42 |        1680 |       01:02:01 |       99.07% |              |       0.0958 |              |      5.0000e-06 |
|      43 |        1700 |       01:02:50 |       99.30% |       98.59% |       0.0702 |       0.1775 |      5.0000e-06 |
|      43 |        1720 |       01:03:33 |       98.90% |              |       0.1144 |              |      5.0000e-06 |
|      44 |        1740 |       01:04:17 |       98.76% |              |       0.1040 |              |      5.0000e-06 |
|      44 |        1760 |       01:04:59 |       98.70% |              |       0.1235 |              |      5.0000e-06 |
|      45 |        1780 |       01:05:43 |       98.92% |              |       0.1177 |              |      5.0000e-06 |
|      45 |        1800 |       01:06:31 |       99.00% |       98.67% |       0.1241 |       0.1599 |      5.0000e-06 |
|      46 |        1820 |       01:07:15 |       98.96% |              |       0.1144 |              |      5.0000e-06 |
|      46 |        1840 |       01:07:57 |       99.23% |              |       0.1036 |              |      5.0000e-06 |
|      47 |        1860 |       01:08:41 |       98.87% |              |       0.1537 |              |      5.0000e-06 |
|      47 |        1880 |       01:09:24 |       98.77% |              |       0.1666 |              |      5.0000e-06 |
|      48 |        1900 |       01:10:13 |       99.04% |       98.71% |       0.1230 |       0.1524 |      5.0000e-06 |
|      48 |        1920 |       01:10:56 |       98.59% |              |       0.1340 |              |      5.0000e-06 |
|      49 |        1940 |       01:11:40 |       98.28% |              |       0.2035 |              |      5.0000e-06 |
|      49 |        1960 |       01:12:22 |       97.76% |              |       0.3152 |              |      5.0000e-06 |
|      50 |        1980 |       01:13:06 |       98.44% |              |       0.2452 |              |      5.0000e-06 |
|      50 |        2000 |       01:13:54 |       98.81% |       98.62% |       0.1104 |       0.1692 |      5.0000e-06 |
|      51 |        2020 |       01:14:38 |       98.49% |              |       0.1236 |              |      5.0000e-07 |
|      51 |        2040 |       01:15:21 |       98.95% |              |       0.1294 |              |      5.0000e-07 |
|      52 |        2060 |       01:16:04 |       99.24% |              |       0.0933 |              |      5.0000e-07 |
|      52 |        2080 |       01:16:47 |       99.24% |              |       0.1003 |              |      5.0000e-07 |
|      53 |        2100 |       01:17:36 |       99.09% |       98.62% |       0.0961 |       0.1697 |      5.0000e-07 |
|      53 |        2120 |       01:18:19 |       99.20% |              |       0.0890 |              |      5.0000e-07 |
|      54 |        2140 |       01:19:03 |       99.02% |              |       0.1092 |              |      5.0000e-07 |
|      54 |        2160 |       01:19:46 |       98.71% |              |       0.1187 |              |      5.0000e-07 |
|      55 |        2180 |       01:20:30 |       99.12% |              |       0.0810 |              |      5.0000e-07 |
|      55 |        2200 |       01:21:18 |       98.81% |       98.66% |       0.1030 |       0.1699 |      5.0000e-07 |
|      56 |        2220 |       01:22:02 |       98.89% |              |       0.1301 |              |      5.0000e-07 |
|      56 |        2240 |       01:22:45 |       99.08% |              |       0.1046 |              |      5.0000e-07 |
|      57 |        2260 |       01:23:29 |       98.93% |              |       0.1074 |              |      5.0000e-07 |
|      57 |        2280 |       01:24:11 |       98.99% |              |       0.1059 |              |      5.0000e-07 |
|      58 |        2300 |       01:25:00 |       98.37% |       98.66% |       0.2003 |       0.1702 |      5.0000e-07 |
|      58 |        2320 |       01:25:43 |       99.00% |              |       0.1018 |              |      5.0000e-07 |
|      59 |        2340 |       01:26:27 |       98.88% |              |       0.1116 |              |      5.0000e-07 |
|      59 |        2360 |       01:27:09 |       99.15% |              |       0.0792 |              |      5.0000e-07 |
|      60 |        2380 |       01:27:53 |       98.87% |              |       0.1149 |              |      5.0000e-07 |
|      60 |        2400 |       01:28:42 |       99.11% |       98.68% |       0.0924 |       0.1583 |      5.0000e-07 |
|      61 |        2420 |       01:29:26 |       98.13% |              |       0.1755 |              |      5.0000e-08 |
|      61 |        2440 |       01:30:08 |       99.10% |              |       0.1210 |              |      5.0000e-08 |
|      62 |        2460 |       01:30:52 |       99.09% |              |       0.0965 |              |      5.0000e-08 |
|      62 |        2480 |       01:31:34 |       99.13% |              |       0.0972 |              |      5.0000e-08 |
|      63 |        2500 |       01:32:24 |       99.14% |       98.63% |       0.0993 |       0.1676 |      5.0000e-08 |
|      63 |        2520 |       01:33:07 |       98.25% |              |       0.1509 |              |      5.0000e-08 |
|      64 |        2540 |       01:33:51 |       99.00% |              |       0.1191 |              |      5.0000e-08 |
|      64 |        2560 |       01:34:33 |       98.38% |              |       0.1466 |              |      5.0000e-08 |
|      65 |        2580 |       01:35:17 |       99.16% |              |       0.0682 |              |      5.0000e-08 |
|      65 |        2600 |       01:36:05 |       98.69% |       98.64% |       0.1206 |       0.1632 |      5.0000e-08 |
|      66 |        2620 |       01:36:49 |       99.25% |              |       0.1033 |              |      5.0000e-08 |
|      66 |        2640 |       01:37:32 |       98.59% |              |       0.1229 |              |      5.0000e-08 |
|      67 |        2660 |       01:38:16 |       99.03% |              |       0.0949 |              |      5.0000e-08 |
|      67 |        2680 |       01:38:58 |       98.96% |              |       0.1174 |              |      5.0000e-08 |
|      68 |        2700 |       01:39:48 |       99.03% |       98.65% |       0.1099 |       0.1648 |      5.0000e-08 |
|      68 |        2720 |       01:40:30 |       98.49% |              |       0.2174 |              |      5.0000e-08 |
|      69 |        2740 |       01:41:14 |       98.82% |              |       0.1104 |              |      5.0000e-08 |
|      69 |        2760 |       01:41:57 |       99.24% |              |       0.0754 |              |      5.0000e-08 |
|      70 |        2780 |       01:42:40 |       99.14% |              |       0.0935 |              |      5.0000e-08 |
|      70 |        2800 |       01:43:29 |       98.83% |       98.64% |       0.1330 |       0.1692 |      5.0000e-08 |
|      71 |        2820 |       01:44:13 |       99.13% |              |       0.0947 |              |      5.0000e-09 |
|      71 |        2840 |       01:44:55 |       99.10% |              |       0.1185 |              |      5.0000e-09 |
|      72 |        2860 |       01:45:39 |       99.09% |              |       0.0967 |              |      5.0000e-09 |
|      72 |        2880 |       01:46:21 |       98.68% |              |       0.1646 |              |      5.0000e-09 |
|      73 |        2900 |       01:47:11 |       99.27% |       98.61% |       0.0806 |       0.1759 |      5.0000e-09 |
|      73 |        2920 |       01:47:54 |       98.88% |              |       0.1027 |              |      5.0000e-09 |
|      74 |        2940 |       01:48:38 |       98.75% |              |       0.1483 |              |      5.0000e-09 |
|      74 |        2960 |       01:49:20 |       99.12% |              |       0.0982 |              |      5.0000e-09 |
|      75 |        2980 |       01:50:04 |       98.67% |              |       0.1247 |              |      5.0000e-09 |
|      75 |        3000 |       01:50:52 |       99.01% |       98.70% |       0.0822 |       0.1615 |      5.0000e-09 |
|      76 |        3020 |       01:51:36 |       99.00% |              |       0.1220 |              |      5.0000e-09 |
|      76 |        3040 |       01:52:19 |       99.05% |              |       0.1080 |              |      5.0000e-09 |
|      77 |        3060 |       01:53:03 |       99.04% |              |       0.0961 |              |      5.0000e-09 |
|      77 |        3080 |       01:53:45 |       98.90% |              |       0.0885 |              |      5.0000e-09 |
{Operation terminated by user during nnet.internal.cnn.DAGNetwork>@()efficientBackProp(i) (line 840)


In nnet.internal.cnn.util.executeWithStagedGPUOOMRecovery (line 11)
        [ varargout{1:nOutputs} ] = computeFun();

In nnet.internal.cnn.DAGNetwork>iExecuteWithStagedGPUOOMRecovery (line 1563)
[varargout{1:nargout}] = nnet.internal.cnn.util.executeWithStagedGPUOOMRecovery(varargin{:});

In nnet.internal.cnn.DAGNetwork/computeGradientsForTraining (line 839)
                    theseGradients = iExecuteWithStagedGPUOOMRecovery( ...

In nnet.internal.cnn.Trainer/computeGradients (line 200)
            [gradients, predictions, states] = net.computeGradientsForTraining(X, Y, propagateState);

In nnet.internal.cnn.Trainer/train (line 119)
                    [gradients, predictions, states] = this.computeGradients(net, X, response, propagateState);

In trainNetwork>doTrainNetwork (line 271)
trainedNet = trainer.train(trainedNet, trainingDispatcher);

In trainNetwork (line 168)
    [trainedNet, info] = doTrainNetwork(layersOrGraph, opts, X, Y);

In train_unet_heartseg (line 104)
[net_train,info] = trainNetwork(train_tf_ds,net,options);
} 
exit; clear; clc
